#!/usr/bin/env bash
set -e
set -o pipefail

echo "---> Python Function Buildpack"

bp_dir=$(cd "$(dirname "$0")"/..; pwd)
build_dir=$(pwd)
layers_dir=$1
platform_dir=$2

source "$bp_dir/lib/build.sh"
rm -rf "$build_dir/__pycache__"

install_or_reuse_invoker "$bp_dir" "$build_dir" "$layers_dir/.invoker"
install_or_reuse_tools "$layers_dir/tools"
install_or_reuse_flask "$layers_dir"
export PATH=$layers_dir/tools/bin:$PATH 